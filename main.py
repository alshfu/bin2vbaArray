from binascii import hexlify, unhexlify

hex_string = ['4d5a90000300000004000000ffff0000b8000000',
              '0000000040000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '800000000e1fba0e00b409cd21b8014ccd215468',
              '69732070726f6772616d2063616e6e6f74206265',
              '2072756e20696e20444f53206d6f64652e0d0d0a',
              '24000000000000005045000064860200bc7312fd',
              '0000000000000000f00022000b02300000080000',
              '0006000000000000000000000020000000000040',
              '0100000000200000000200000400000000000000',
              '0400000000000000006000000002000000000000',
              '0300408500004000000000000040000000000000',
              '0000100000000000002000000000000000000000',
              '1000000000000000000000000000000000000000',
              '00400000c0050000000000000000000000000000',
              '0000000000000000000000002c26000038000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000200000',
              '4800000000000000000000002e74657874000000',
              'cf06000000200000000800000002000000000000',
              '0000000000000000200000602e72737263000000',
              'c00500000040000000060000000a000000000000',
              '0000000000000000400000400000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000004800000002000500',
              '5c200000d0050000010000000100000600000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '000000002e7201000070280f00000a2a1e022810',
              '00000a2a42534a4201000100000000000c000000',
              '76342e302e33303331390000000005006c000000',
              'cc010000237e0000380200005802000023537472',
              '696e677300000000900400001c00000023555300',
              'ac040000100000002347554944000000bc040000',
              '1401000023426c6f620000000000000002000001',
              '471500000900000000fa01330016000001000000',
              '1100000002000000020000000100000010000000',
              '0e00000001000000010000000000950101000000',
              '000006000a011c02060077011c0206003e00ea01',
              '0f003c02000006006600d2010600ed00d2010600',
              'ce00d20106005e01d20106002a01d20106004301',
              'd20106007d00d20106005200fd0106003000fd01',
              '0600b100d20106009800a40106005002c6010600',
              '1e00c60100000000010000000000010001000000',
              '1000be0113004100010001004820000000009100',
              'cd01280001005420000000008618e40106000200',
              '000001004b020900e40101001100e40106001900',
              'e4010a002900e40110003100e40110003900e401',
              '10004100e40110004900e40110005100e4011000',
              '5900e40110006100e40115006900e40110007100',
              'e40110007900e4011000890026001a008100e401',
              '06002e000b002e002e00130037002e001b005600',
              '2e0023005f002e002b006f002e0033006f002e00',
              '3b0075002e0043005f002e004b007c002e005300',
              '6f002e005b006f002e00630095002e006b00bf00',
              '2e007300cc000480000001000000000000000000',
              '0000000013000000040000000000000000000000',
              '1f000a000000000000000000003c4d6f64756c65',
              '3e006d73636f726c69620048656c6c6f576f726c',
              '6400436f6e736f6c650057726974654c696e6500',
              '4775696441747472696275746500446562756767',
              '61626c6541747472696275746500436f6d566973',
              '69626c6541747472696275746500417373656d62',
              '6c795469746c6541747472696275746500417373',
              '656d626c7954726164656d61726b417474726962',
              '757465005461726765744672616d65776f726b41',
              '747472696275746500417373656d626c7946696c',
              '6556657273696f6e417474726962757465004173',
              '73656d626c79436f6e66696775726174696f6e41',
              '747472696275746500417373656d626c79446573',
              '6372697074696f6e41747472696275746500436f',
              '6d70696c6174696f6e52656c61786174696f6e73',
              '41747472696275746500417373656d626c795072',
              '6f6475637441747472696275746500417373656d',
              '626c79436f707972696768744174747269627574',
              '6500417373656d626c79436f6d70616e79417474',
              '7269627574650052756e74696d65436f6d706174',
              '6962696c6974794174747269627574650048656c',
              '6c6f576f726c642e6578650053797374656d2e52',
              '756e74696d652e56657273696f6e696e67005072',
              '6f6772616d0053797374656d004d61696e005379',
              '7374656d2e5265666c656374696f6e002e63746f',
              '720053797374656d2e446961676e6f7374696373',
              '0053797374656d2e52756e74696d652e496e7465',
              '726f7053657276696365730053797374656d2e52',
              '756e74696d652e436f6d70696c65725365727669',
              '63657300446562756767696e674d6f6465730061',
              '726773004f626a65637400000017480065006c00',
              '6c006f00200057006f0072006c00640000000000',
              '760ea445745ca84c98d06c77cc08d74f00042001',
              '010803200001052001011111042001010e042001',
              '0102040001010e08b77a5c561934e08905000101',
              '1d0e0801000800000000001e0100010054021657',
              '7261704e6f6e457863657074696f6e5468726f77',
              '73010801000200000000000f01000a48656c6c6f',
              '576f726c640000050100000000060100012e0000',
              '18010013436f7079726967687420c2a9202e2032',
              '30323000002901002463363636333461342d6631',
              '31392d343233362d623864322d61303835643430',
              '653537633700000c010007312e302e302e300000',
              '4701001a2e4e45544672616d65776f726b2c5665',
              '7273696f6e3d76342e300100540e144672616d65',
              '776f726b446973706c61794e616d65102e4e4554',
              '204672616d65776f726b203400000000fe8453c9',
              '00000000020000006b0000006426000064080000',
              '0000000000000000000000001000000000000000',
              '000000000000000052534453a66307d09b84b944',
              'bf030bff2d7d1e4a01000000433a5c5573657273',
              '5c746d63677566665c736f757263655c7265706f',
              '735c48656c6c6f576f726c645c48656c6c6f576f',
              '726c645c6f626a5c7836345c52656c656173655c',
              '48656c6c6f576f726c642e706462000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000020010000000',
              '2000008018000000500000800000000000000000',
              '0000000000000100010000003800008000000000',
              '0000000000000000000001000000000080000000',
              '0000000000000000000000000000010001000000',
              '6800008000000000000000000000000000000100',
              '00000000c0030000904000003003000000000000',
              '00000000300334000000560053005f0056004500',
              '5200530049004f004e005f0049004e0046004f00',
              '00000000bd04effe000001000000010000000000',
              '00000100000000003f0000000000000004000000',
              '0100000000000000000000000000000044000000',
              '0100560061007200460069006c00650049006e00',
              '66006f0000000000240004000000540072006100',
              '6e0073006c006100740069006f006e0000000000',
              '0000b00490020000010053007400720069006e00',
              '6700460069006c00650049006e0066006f000000',
              '6c02000001003000300030003000300034006200',
              '300000001a000100010043006f006d006d006500',
              '6e00740073000000000000002400020001004300',
              '6f006d00700061006e0079004e0061006d006500',
              '000000002e0000003e000b000100460069006c00',
              '6500440065007300630072006900700074006900',
              '6f006e0000000000480065006c006c006f005700',
              '6f0072006c006400000000003000080001004600',
              '69006c006500560065007200730069006f006e00',
              '0000000031002e0030002e0030002e0030000000',
              '3e000f00010049006e007400650072006e006100',
              '6c004e0061006d0065000000480065006c006c00',
              '6f0057006f0072006c0064002e00650078006500',
              '000000004a00130001004c006500670061006c00',
              '43006f0070007900720069006700680074000000',
              '43006f0070007900720069006700680074002000',
              'a90020002e002000320030003200300000000000',
              '2a00010001004c006500670061006c0054007200',
              '6100640065006d00610072006b00730000000000',
              '0000000046000f0001004f007200690067006900',
              '6e0061006c00460069006c0065006e0061006d00',
              '65000000480065006c006c006f0057006f007200',
              '6c0064002e006500780065000000000036000b00',
              '0100500072006f0064007500630074004e006100',
              '6d00650000000000480065006c006c006f005700',
              '6f0072006c006400000000003400080001005000',
              '72006f0064007500630074005600650072007300',
              '69006f006e00000031002e0030002e0030002e00',
              '3000000038000800010041007300730065006d00',
              '62006c0079002000560065007200730069006f00',
              '6e00000031002e0030002e0030002e0030000000',
              'd0430000ea0100000000000000000000efbbbf3c',
              '3f786d6c2076657273696f6e3d22312e30222065',
              '6e636f64696e673d225554462d3822207374616e',
              '64616c6f6e653d22796573223f3e0d0a0d0a3c61',
              '7373656d626c7920786d6c6e733d2275726e3a73',
              '6368656d61732d6d6963726f736f66742d636f6d',
              '3a61736d2e763122206d616e6966657374566572',
              '73696f6e3d22312e30223e0d0a20203c61737365',
              '6d626c794964656e746974792076657273696f6e',
              '3d22312e302e302e3022206e616d653d224d7941',
              '70706c69636174696f6e2e617070222f3e0d0a20',
              '203c7472757374496e666f20786d6c6e733d2275',
              '726e3a736368656d61732d6d6963726f736f6674',
              '2d636f6d3a61736d2e7632223e0d0a202020203c',
              '73656375726974793e0d0a2020202020203c7265',
              '7175657374656450726976696c6567657320786d',
              '6c6e733d2275726e3a736368656d61732d6d6963',
              '726f736f66742d636f6d3a61736d2e7633223e0d',
              '0a20202020202020203c72657175657374656445',
              '7865637574696f6e4c6576656c206c6576656c3d',
              '226173496e766f6b657222207569416363657373',
              '3d2266616c7365222f3e0d0a2020202020203c2f',
              '72657175657374656450726976696c656765733e',
              '0d0a202020203c2f73656375726974793e0d0a20',
              '203c2f7472757374496e666f3e0d0a3c2f617373',
              '656d626c793e0000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '0000000000000000000000000000000000000000',
              '00000000000000000000000000000000']


def file2hex_array(input_file, output_file):
    with open(input_file, "rb") as fd_in, open(output_file, "wb") as fd_out:
        fd_out.write(b"Dim Films(1 To 205) As String")
        fd_out.write(b"\n")
        i = 1
        while chunk := fd_in.read(20):
            # _string = f'''Films({i}) = "'''
            _string = f'''Films({i}) = "'''
            fd_out.write(bytes(_string, 'utf-8'))
            fd_out.write(hexlify(chunk))
            fd_out.write(b'"')
            fd_out.write(b"\n")
            i = i + 1
        fd_out.write(b"]")


# def file2hex(input_file, output_file):
#    with open(input_file, "rb") as fd_in, open(output_file, "wb") as fd_out:
#        while chunk := fd_in.read(20):
#            fd_out.write(hexlify(chunk))
#            fd_out.write(b"\n")


def hex2file(input_file, output_file):
    with open(input_file, "rb") as fd_in, open(output_file, "wb") as fd_out:
        for line in fd_in:
            fd_out.write(unhexlify(line.rstrip()))


def string2file(hex_str, output_file):
    with open(output_file, "wb") as fd_out:
        for line in hex_str:
            print(line)
            fd_out.write(unhexlify(line.rstrip()))


if __name__ == '__main__':
    file2hex_array(f"""exe\\HelloWorld.exe""", f"""hex\\new.hex""")
    #   string2file(hex_string, f"""exe\\new_2.0.exe""")
    #   file2hex(f"""exe\\HelloWorld.exe""", f"""hex\\test.hex""")
    #   hex2file(f"""hex\\test.hex""", f"""exe\\new.exe""")
    #   hex2file(hex_string, f"""exe\\new_v2.exe""")
